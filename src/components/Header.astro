---
import If from "./jinja/If.astro";
import { pages } from "../lib/pages";

const currentPath = Astro.url.pathname.replace(".html", ""); // price of disabling index.html

interface Props {
  loggedIn: "y" | "n" | "auto";
}
const { loggedIn } = Astro.props;
---

<header>
  <nav>
    {
      pages.map(({ href, title, icon, loggedInOnly }) => {
        const isSelected = currentPath == href;
        const navItem = (
          <a class="font-label-medium" href={href}>
            <div class:list={{ content: true, selected: isSelected, layer: true }}>
              <svg width="24" height="24" viewBox="0 0 24 24">
                <Fragment set:html={icon} />
              </svg>
              <span>{title}</span>
            </div>
          </a>
        );

        if (!loggedInOnly) {
          return navItem;
        } else {
          if (loggedIn != "auto") {
            return loggedIn == "y" ? navItem : null;
          } else {
            return <If condition="loggedin">{navItem}</If>;
          }
        }
      })
    }
  </nav>
</header>

<style>
  header {
    display: grid;
  }

  nav {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  a {
    display: flex;
    align-items: center;
    height: 4rem;
  }

  .content {
    display: flex;
    align-items: center;
    height: 2.5rem;
    border-radius: 1.25rem;
    gap: 0.5rem;
    padding-inline: 1rem;
    position: relative;
  }

  .content.selected {
    background-color: rgb(var(--m3-scheme-secondary-container));
    color: rgb(var(--m3-scheme-on-secondary-container));
  }
</style>
